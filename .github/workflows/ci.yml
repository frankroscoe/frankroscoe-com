name: Portfolio CI (Lint + W3C Validation)

on:
  push:
    branches: [ "main" ]
  pull_request:

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      # Step 1: Checkout repo
      - uses: actions/checkout@v4

      # Step 2: Set up Node.js
      - uses: actions/setup-node@v4
        with:
          node-version: 20

      # Step 3: Install linters + tools
      - run: npm install -g htmlhint stylelint eslint jq curl

      # Step 4: Run HTML lint
      - run: htmlhint .

      # Step 5: Run CSS lint
      - run: stylelint "**/*.css"

      # Step 6: Run JS lint
      - run: eslint "**/*.js"

      # Step 7: W3C HTML validation
      - name: W3C HTML Validation
        run: |
          curl -s "https://validator.w3.org/nu/?doc=https://www.frankroscoe.com&out=json" \
            | jq '.messages[] | select(.type=="error")'

      # Step 8: W3C CSS validation
      - name: W3C CSS Validation
        run: |
          curl -s "https://jigsaw.w3.org/css-validator/validator?uri=https://www.frankroscoe.com&output=json" \
            | jq '.cssvalidation.errors'
